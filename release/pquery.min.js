/**
 * almond 0.1.2 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
 * Contains the slick.parser library
 * https://github.com/subtleGradient/slick
 */

// Credit: XRegExp 0.6.1 (c) 2007-2008 Steven Levithan <http://stevenlevithan.com/regex/xregexp/> MIT License

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
		 * Contains modified parts of jQuery JavaScript Library v1.7.2
		 * http://jquery.com/
		 *
		 * Copyright 2011, John Resig
		 * Dual licensed under the MIT or GPL Version 2 licenses.
		 * http://jquery.org/license
		 *
		 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
		 * Contains callbacks.js of jQuery JavaScript Library v1.8pre
		 * http://jquery.com/
		 *
		 * Copyright 2011, John Resig
		 * Dual licensed under the MIT or GPL Version 2 licenses.
		 * http://jquery.org/license
		 *
		 * Date: Sun Aug 19 2012
		 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */

/*!
 * pQuery physics library v0.1a
 * https://github.com/wellcaffeinated/pQuery
 * 
 * Copyright 2012, Jasper Palfree
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * 
 * Date: Sun Aug 19 2012
 * @license
 */

/*!
		 * Contains modified parts of jQuery JavaScript Library v1.7.2
		 * http://jquery.com/
		 *
		 * Copyright 2011, John Resig
		 * Dual licensed under the MIT or GPL Version 2 licenses.
		 * http://jquery.org/license
		 *
		 */

(function(window,document,undefined){var requirejs,require,define;(function(undef){function normalize(name,baseName){var baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{},nameParts,nameSegment,mapValue,foundMap,foundI,foundStarMap,starI,i,j,part;if(name&&name.charAt(0)==="."&&baseName){baseParts=baseParts.slice(0,baseParts.length-1),name=baseParts.concat(name.split("/"));for(i=0;part=name[i];i++)if(part===".")name.splice(i,1),i-=1;else if(part===".."){if(i===1&&(name[2]===".."||name[0]===".."))return!0;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts)for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue,foundI=i;break}}}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(waiting.hasOwnProperty(name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!defined.hasOwnProperty(name))throw new Error("No "+name);return defined[name]}function makeMap(name,relName){var prefix,plugin,index=name.indexOf("!");return index!==-1?(prefix=normalize(name.slice(0,index),relName),name=name.slice(index+1),plugin=callDep(prefix),plugin&&plugin.normalize?name=plugin.normalize(name,makeNormalize(relName)):name=normalize(name,relName)):name=normalize(name,relName),{f:prefix?prefix+"!"+name:name,n:name,p:plugin}}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var defined={},waiting={},config={},defining={},aps=[].slice,main,req;main=function(name,deps,callback,relName){var args=[],usingExports,cjsModule,depName,ret,map,i;relName=relName||name;if(typeof callback=="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i++){map=makeMap(deps[i],relName),depName=map.f;if(depName==="require")args[i]=makeRequire(name);else if(depName==="exports")args[i]=defined[name]={},usingExports=!0;else if(depName==="module")cjsModule=args[i]={id:name,uri:"",exports:defined[name],config:makeConfig(name)};else if(defined.hasOwnProperty(depName)||waiting.hasOwnProperty(depName))args[i]=callDep(depName);else if(map.p)map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName];else if(!defining[depName])throw new Error(name+" missing "+depName)}ret=callback.apply(defined[name],args);if(name)if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name])defined[name]=cjsModule.exports;else if(ret!==undef||!usingExports)defined[name]=ret}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync){return typeof deps=="string"?callDep(makeMap(deps,callback).f):(deps.splice||(config=deps,callback.splice?(deps=callback,callback=relName,relName=null):deps=undef),callback=callback||function(){},forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},15),req)},req.config=function(cfg){return config=cfg,req},define=function(name,deps,callback){deps.splice||(callback=deps,deps=[]),waiting[name]=[name,deps,callback]},define.amd={jQuery:!0}})(),define("almond",function(){}),define("util/slick.parser",[],function(){function parser(rawMatch,separator,combinator,combinatorChildren,tagName,id,className,attributeKey,attributeOperator,attributeQuote,attributeValue,pseudoClass,pseudoQuote,pseudoClassValue){if(separator||separatorIndex===-1){parsed.expressions[++separatorIndex]=[],combinatorIndex=-1;if(separator)return""}if(combinator||combinatorChildren||combinatorIndex===-1){combinator=combinator||" ";var currentSeparator=parsed.expressions[separatorIndex];reversed&&currentSeparator[combinatorIndex]&&(currentSeparator[combinatorIndex].reverseCombinator=reverseCombinator(combinator)),currentSeparator[++combinatorIndex]={combinator:combinator,tag:"*"}}var currentParsed=parsed.expressions[separatorIndex][combinatorIndex];if(tagName)currentParsed.tag=tagName.replace(reUnescape,"");else if(id)currentParsed.id=id.replace(reUnescape,"");else if(className)className=className.replace(reUnescape,""),currentParsed.classList||(currentParsed.classList=[]),currentParsed.classes||(currentParsed.classes=[]),currentParsed.classList.push(className),currentParsed.classes.push({value:className,regexp:new RegExp("(^|\\s)"+escapeRegExp(className)+"(\\s|$)")});else if(pseudoClass)pseudoClassValue=pseudoClassValue?pseudoClassValue.replace(reUnescape,""):null,currentParsed.pseudos||(currentParsed.pseudos=[]),currentParsed.pseudos.push({key:pseudoClass.replace(reUnescape,""),value:pseudoClassValue});else if(attributeKey){attributeKey=attributeKey.replace(reUnescape,""),attributeValue=(attributeValue||"").replace(reUnescape,"");var test,regexp;switch(attributeOperator){case"^=":regexp=new RegExp("^"+escapeRegExp(attributeValue));break;case"$=":regexp=new RegExp(escapeRegExp(attributeValue)+"$");break;case"~=":regexp=new RegExp("(^|\\s)"+escapeRegExp(attributeValue)+"(\\s|$)");break;case"|=":regexp=new RegExp("^"+escapeRegExp(attributeValue)+"(-|$)");break;case"=":test=function(value){return attributeValue==value};break;case"*=":test=function(value){return value&&value.indexOf(attributeValue)>-1};break;case"!=":test=function(value){return attributeValue!=value};break;default:test=function(value){return!!value}}test||(test=function(value){return value&&regexp.test(value)}),currentParsed.attributes||(currentParsed.attributes=[]),currentParsed.attributes.push({key:attributeKey,operator:attributeOperator,value:attributeValue,test:test})}return""}var parsed,separatorIndex,combinatorIndex,reversed,cache={},reverseCache={},reUnescape=/\\/g,parse=function(expression,isReversed){if(!expression)return null;if(expression.Slick===!0)return expression;expression=(""+expression).replace(/^\s+|\s+$/g,""),reversed=!!isReversed;var currentCache=reversed?reverseCache:cache;if(currentCache[expression])return currentCache[expression];parsed={Slick:!0,expressions:[],raw:expression,reverse:function(){return parse(this.raw,!0)}},separatorIndex=-1;while(expression!=(expression=expression.replace(regexp,parser)));return parsed.length=parsed.expressions.length,currentCache[expression]=reversed?reverse(parsed):parsed},reverseCombinator=function(combinator){return combinator==="!"?" ":combinator===" "?"!":/^!/.test(combinator)?combinator.replace(/^!/,""):"!"+combinator},reverse=function(expression){var expressions=expression.expressions;for(var i=0;i<expressions.length;i++){var exp=expressions[i],last={parts:[],tag:"*",combinator:reverseCombinator(exp[0].combinator)};for(var j=0;j<exp.length;j++){var cexp=exp[j];cexp.reverseCombinator||(cexp.reverseCombinator=" "),cexp.combinator=cexp.reverseCombinator,delete cexp.reverseCombinator}exp.reverse().push(last)}return expression},escapeRegExp=function(string){return string.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,"\\$&")},regexp=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|:+(<unicode>+)(?:\\((?:([\"']?)((?:\\([^\\)]+\\)|[^\\(\\)]*)+)\\12)\\))?)".replace(/<combinator>/,"["+escapeRegExp(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),Slick=this.Slick||{};return Slick.parse=function(expression){return parse(expression)},Slick.escapeRegExp=escapeRegExp,Slick}),define("util/tools",[],function(){Array.prototype.indexOf=Array.prototype.indexOf||function(searchElement,fromIndex){if(this==null)throw new TypeError;var t=Object(this),len=t.length>>>0;if(len===0)return-1;var n=0;arguments.length>0&&(n=Number(arguments[1]),n!=n?n=0:n!=0&&n!=Infinity&&n!=-Infinity&&(n=(n>0||-1)*Math.floor(Math.abs(n))));if(n>=len)return-1;var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++)if(k in t&&t[k]===searchElement)return k;return-1};var class2type={},toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,Tools={extend:function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;typeof target=="boolean"&&(deep=target,target=arguments[1]||{},i=2),typeof target!="object"&&!Tools.isFunction(target)&&(target={}),length===i&&(target=this,--i);for(;i<length;i++)if((options=arguments[i])!=null)for(name in options){src=target[name],copy=options[name];if(target===copy)continue;deep&&copy&&(Tools.isPlainObject(copy)||(copyIsArray=Tools.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Tools.isArray(src)?src:[]):clone=src&&Tools.isPlainObject(src)?src:{},target[name]=Tools.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy)}return target},isFunction:function(obj){return Tools.type(obj)==="function"},isArray:Array.isArray||function(obj){return Tools.type(obj)==="array"},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},isNumericQuick:function(obj){return obj===0||obj==="0"||(obj&&obj!==!0?obj>>>0!=0||(obj*=obj)*obj<obj:!1)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object"},isPlainObject:function(obj){if(!obj||Tools.type(obj)!=="object"||obj.nodeType||obj==obj.window)return!1;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var key;for(key in obj);return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj)return!1;return!0},error:function(msg){throw new Error(msg)},noop:function(){},each:function(object,callback,args){var name,i=0,length=object.length,isObj=length===undefined||Tools.isFunction(object);if(args){if(isObj){for(name in object)if(callback.apply(object[name],args)===!1)break}else for(;i<length;)if(callback.apply(object[i++],args)===!1)break}else if(isObj){for(name in object)if(callback.call(object[name],name,object[name])===!1)break}else for(;i<length;)if(callback.call(object[i],i,object[i++])===!1)break;return object},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=Tools.type(array);array.length==null||type==="string"||type==="function"||type==="regexp"||array===array.window?push.call(ret,array):Tools.merge(ret,array)}return ret},merge:function(first,second){var i=first.length,j=0;if(typeof second.length=="number")for(var l=second.length;j<l;j++)first[i++]=second[j];else while(second[j]!==undefined)first[i++]=second[j++];return first.length=i,first},parseXML:function(data){if(typeof data!="string"||!data)return null;var xml,tmp;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=undefined}return(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length)&&Tools.error("Invalid XML: "+data),xml},now:function(){return(new Date).getTime()},guid:1,proxy:function(fn,context){if(typeof context=="string"){var tmp=fn[context];context=fn,fn=tmp}if(!Tools.isFunction(fn))return undefined;var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};return proxy.guid=fn.guid=fn.guid||proxy.guid||Tools.guid++,proxy},unique:function(results){var i,j,l;for(i=0,l=results.length;i<l;i++)for(j=i+1;j<l;j++)results[i]===results[j]&&(results.splice(j--,1),l--);return results}};return Tools.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),Tools}),define("util/callbacks",["./tools"],function(Tools){(function(jQuery){function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.split(/\s+/),function(_,flag){object[flag]=!0}),object}var optionsCache={};jQuery.Callbacks=function(options){options=typeof options=="string"?optionsCache[options]||createOptions(options):jQuery.extend({},options);var list=[],stack=!options.once&&[],memory,fired,firing,firingStart,firingLength,firingIndex,fire=function(data){memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;for(;list&&firingIndex<firingLength;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;(function e(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)&&(!options.unique||!self.has(arg))?list.push(arg):arg&&arg.length&&add(arg)})})(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1)list.splice(index,1),firing&&(index<=firingLength&&firingLength--,index<=firingIndex&&firingIndex--)}),this},has:function(fn){return jQuery.inArray(fn,list)>-1},empty:function(){return list=[],this},disable:function(){return list=stack=memory=undefined,this},disabled:function(){return!list},lock:function(){return stack=undefined,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return args=args||[],args=[context,args.slice?args.slice():args],list&&(!fired||stack)&&(firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self}})(Tools);var ret=Tools.Callbacks;return Tools.Callbacks=undefined,ret}),define("util/request-anim-frame",["require"],function(win){var API={},win=window,lastTime=0,vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x)API.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"],API.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(API.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id}),window.cancelAnimationFrame||(API.cancelAnimationFrame=function(id){clearTimeout(id)}),API}),define("util/ticker",["./request-anim-frame"],function(frame){function each(arr,fn){for(var i=0,l=arr.length;i<l;++i)if(fn(arr[i],i)===!1)return!1;return!0}function step(time){if(!active)return;frame.requestAnimationFrame(step),each(listeners,function(l){l(time,time-lastTime)}),lastTime=time}function start(){return lastTime=(new Date).getTime(),active=!0,step(),API}function stop(){return active=!1,API}function subscribe(listener){function cb(l){if(l===listener)return!1}return typeof listener=="function"&&each(listeners,cb)&&listeners.push(listener),API}function unsubscribe(listener){return each(listeners,function(l,i){if(l===listener)return listeners.splice(i,1),!1}),API}function isActive(){return!!active}var API,lastTime=0,active=!1,listeners=[];return API={start:start,stop:stop,subscribe:subscribe,unsubscribe:unsubscribe,isActive:isActive}}),define("math/vector2",[],function(){function Vector(x,y){if(!(this instanceof arguments.callee))return new Vector(x,y);this.set(x||0,y||0)}return Vector.vadd=function(v1,v2){return new Vector(v1.x+v2.x,v1.y+v2.y)},Vector.vsub=function(v1,v2){return new Vector(v1.x-v2.x,v1.y-v2.y)},Vector.mult=function(m,v1){return new Vector(v1.x*m,v.y*m)},Vector.proj=function(v1,v2){return Vector.mult(v1.dot(v2)/v2.normSq(),v2)},Vector.prototype.set=function(x,y){return this._norm=!1,this._normSq=!1,this.x=x,this.y=y,this},Vector.prototype.vadd=function(v){return this._norm=!1,this._normSq=!1,this.x+=v.x,this.y+=v.y,this},Vector.prototype.vsub=function(v){return this._norm=!1,this._normSq=!1,this.x-=v.x,this.y-=v.y,this},Vector.prototype.add=function(x,y){return this._norm=!1,this._normSq=!1,this.x+=x,this.y+=y===undefined?x:y,this},Vector.prototype.sub=function(x,y){return this._norm=!1,this._normSq=!1,this.x-=x,this.y-=y===undefined?x:y,this},Vector.prototype.mult=function(m){return this._normSq&&(this._normSq*=m,this._norm*=m),this.x*=m,this.y*=m,this},Vector.prototype.dot=function(v){return this.x*v.x+this.y*v.y},Vector.prototype.cross=function(v){return this.x*v.y-this.y*v.x},Vector.prototype.proj=function(v){var m=this.dot(v)/v.normSq();return this.clone(v).mult(m)},Vector.prototype.norm=function(){return this._norm!==!1?this._norm:this._norm=Math.sqrt(this._normSq=this.x*this.x+this.y*this.y)},Vector.prototype.normSq=function(){return this._normSq!==!1?this._normSq:this._normSq=this.x*this.x+this.y*this.y},Vector.prototype.dist=function(v){var dx,dy;return Math.sqrt((dx=v.x-this.x)*dx+(dy=v.y-this.y)*dy)},Vector.prototype.distSq=function(v){var dx,dy;return(dx=v.x-this.x)*dx+(dy=v.y-this.y)*dy},Vector.prototype.normalize=function(){var m=this.norm();return m===0?this:(this.x/=m,this.y/=m,this._norm=1,this._normSq=1,this)},Vector.prototype.clone=function(v){return v?(this._norm=!1,this._normSq=!1,this.x=v.x,this.y=v.y,this):new Vector(this.x,this.y)},Vector.prototype.toNative=function(){return{x:this.x,y:this.y}},Vector.prototype.copyTo=function(v){return v.clone(this),this},Vector.prototype.zero=function(){return this._norm=0,this._normSq=0,this.x=0,this.y=0,this},Vector.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Vector.prototype.clamp=function(minV,maxV){return this.x=Math.min(Math.max(this.x,minV.x),maxV.x),this.y=Math.min(Math.max(this.y,minV.y),maxV.y),this._norm=this._normSq=!1,this},Vector.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Vector}),define("math/vector",["./vector2"],function(Vector){return Vector}),define("physics/algorithms",["../util/tools","../math/vector"],function(Tools,Vector){return{interactions:{NewtonianGravity:function(strength){var i,l,other,pos,otherpos=new Vector,lensq,g;return{beforeAccel:function(dt,obj,idx,list){for(i=idx+1,l=list.length;i<l;i++)pos=obj.position(),other=list[i],otherpos.clone(other.position()),otherpos.vsub(pos),lensq=otherpos.normSq(),g=strength/lensq,obj.accelerate(otherpos.normalize().mult(g)),other.accelerate(otherpos.negate())}}},Drag:function(strength){var v=new Vector,l,x,y,z;return strength=Math.max(Math.min(strength,1),0),{beforeAccel:function(dt,obj,idx,list){v.clone(obj.velocity()),v.mult(1-strength),obj.velocity(v)}}},SphereCollide:function(friction){function fn(dt,obj,idx,list){if(obj.attr("fixed"))return;pos1.clone(obj.position()),r=obj.dimensions().radius;for(i=idx+1,l=list.length;i<l;i++){other=list[i],fixed=other.attr("fixed"),diff.clone(pos2.clone(other.position())),diff.vsub(pos1),target=r+other.dimensions().radius;if(diff.x<target&&diff.y<target&&(len=diff.norm())<target){factor=(fixed?1:.5)*(len-target)/len,preserveImpulse&&(v1.clone(obj.velocity()),v2.clone(other.velocity())),obj.position(pos1.vadd(diff.mult(factor))),fixed||other.position(pos2.vsub(diff));if(preserveImpulse){diff.normalize(),factor=v2.dot(diff)-v1.dot(diff);if(factor>=0)continue;if(fixed){obj.velocity(v1.mult(-1));continue}diff.mult(factor*(1-.5*friction)),v1.vadd(diff),v2.vsub(diff),obj.velocity(v1),other.velocity(v2)}}}}var len,target,diff=new Vector,pos1=new Vector,pos2=new Vector,r,i,l,v1=new Vector,v2=new Vector,other,factor,fixed,preserveImpulse=!1;return friction=Math.max(Math.min(friction,1),0),{afterAccel:fn,afterInertia:function(dt,obj,idx,list){preserveImpulse=!0,fn(dt,obj,idx,list),preserveImpulse=!1}}},ConstrainWithin:function(boundsOrParent,energyLoss){function fn(dt,obj,idx,list,par){pos.clone(obj.position()),whd=obj.dimensions(),whd.radius?whd.x=whd.y=whd.z=whd.radius:(whd.x/=2,whd.y/=2,whd.z/=2);if(preserveImpulse){v.clone(obj.velocity());if(pos.x>max.x-whd.x||pos.x<min.x+whd.x)v.x=(energyLoss-1)*v.x;if(pos.y>max.y-whd.y||pos.y<min.y+whd.y)v.y=(energyLoss-1)*v.y;if(pos.z>max.z-whd.z||pos.z<min.z+whd.z)v.z=(energyLoss-1)*v.z}pos.clamp({x:min.x+whd.x,y:min.y+whd.y,z:min.z+whd.z},{x:max.x-whd.x,y:max.y-whd.y,z:max.z-whd.z}),obj.position(pos),preserveImpulse&&obj.velocity(v)}var pos=new Vector,v=new Vector,min,max,whd,upper,lower,count,fric,preserveImpulse=!1;return typeof boundsOrParent.dimensions=="function"?(typeof boundsOrParent.position=="function"&&(min=boundsOrParent.position()),min=min||{x:0,y:0,z:0},whd=max=boundsOrParent.dimensions()):typeof boundsOrParent=="object"?(min=boundsOrParent,whd=boundsOrParent):min=whd={},min.x=Tools.isNumericQuick(min.x)?min.x:-1/0,min.y=Tools.isNumericQuick(min.y)?min.y:-1/0,min.z=Tools.isNumericQuick(min.z)?min.z:-1/0,max.x=min.x+whd.x,max.y=min.y+whd.y,max.z=min.z+whd.z,max.x=Tools.isNumericQuick(max.x)?max.x:1/0,max.y=Tools.isNumericQuick(max.y)?max.y:1/0,max.z=Tools.isNumericQuick(max.z)?max.z:1/0,{afterAccel:fn,afterInertia:function(dt,obj,idx,list,par){preserveImpulse=!0,fn(dt,obj,idx,list,par),preserveImpulse=!1}}}}}}),define("util/class",["./tools"],function(Tools){function Class(obj,name){var constructor=name?obj[name]:obj.__constructor__||Tools.noop;if(obj.__extends__)var base=obj.__extends__.prototype;else var base={};return constructor.prototype=Tools.extend({},base,obj),constructor}return Class}),define("physics/body",["../util/class","../util/tools","../util/callbacks"],function(Class,Tools,Callbacks){var idSeed="body"+(""+Math.random()).replace(/\D/g,""),lastId=0,Body=Class({_type:"body",_events:["modified","children.modified"],Body:function(id){var _=this._={};_.id=id||null,_.classes=[],_.oldclasses=this._classes,_.parent=null,_.children={},_.callbacks={},_.bubble={},_.attr={},_.data={};var evt,self=this;for(var i=0,l=this._events.length;i<l;i++)evt=this._events[i],!function(cb){_.bubble[evt]=function(){cb.fire.apply(cb,arguments)}}(_.callbacks[evt]=Callbacks())},_fire:function(evt,args){return this._.callbacks[evt].fire(args),this},subscribe:function(evt,callback){var cb=this._.callbacks[evt];return cb&&cb.add(callback),this},unsubscribe:function(evt,callback){var cb=this._.callbacks[evt];return cb&&cb.remove(callback),this},requestUniqueId:function(){return idSeed+lastId++},type:function(){return this._type},attr:function(key,val){return val?this._.attr[key]=val:this._.attr[key]},id:function(val){var _=this._,par=this.parent();return val&&typeof val=="string"?par?(par.remove(this),_.id=val,par.add(this),_.id):(_.id!==val&&this._fire("modified",[[this],this,"id"]),_.id=val):_.id||(par?_.id=par.requestUniqueId():null)},addClass:function(str){var _=this._,oldlen=_.classes.length;return this.removeClass(str),_.classes.push.apply(_.classes,str.split(" ")),_.classes.length!==oldlen&&this._fire("modified",[[this],this,"classes"]),this},removeClass:function(str){var _=this._,cls=str.split(" "),classes=_.classes,idx,oldlen=_.classes.length;for(var i=0,l=cls.length;i<l;++i)(idx=classes.indexOf(cls[i]))>=0&&classes.splice(idx,1);return _.classes.length!==oldlen&&this._fire("modified",[[this],this,"classes"]),this},toggleClass:function(str,stateVal){var type=typeof str,isBool=typeof stateVal=="boolean";if(type==="string"){var cls=str.split(" "),c,state=stateVal,i=0;while(c=cls[i++])state=isBool?state:!this.hasClass(c),this[state?"addClass":"removeClass"](c)}else if(type==="undefined"||type==="boolean"){var _=this._,l,old=_.classes;if(l=_.classes.length)_.oldclasses=_.classes;_.classes=l&&str!==!0||str===!1?[]:_.oldclasses||[],old!==_.classes&&this._fire("modified",[[this],this,"classes"])}return this},classes:function(str){return str&&this.addClass(str),this._.classes.join(" ")},hasClass:function(str){var args=[].slice.call(arguments),a,ret=!0;while(a=args.shift())ret=ret&&this._.classes.indexOf(a)>=0;return ret},add:function(body){var _=this._;return body.parent(this)===this&&(_.children[body.id()]=body,body.subscribe("children.modified",_.bubble["children.modified"]),body.subscribe("modified",_.bubble["children.modified"]),this._fire("children.modified",[[body],this,"children"])),this},addTo:function(par){return par.add(this),this},remove:function(body){var _=this._;return body.parent()===this&&(body.parent(null),delete _.children[body.id()],body.unsubscribe("children.modified",_.bubble["children.modified"]),body.unsubscribe("modified",_.bubble["children.modified"]),this._fire("children.modified",[[body],this,"children"])),this},parent:function(par){var _=this._;return(par||par===null)&&_.parent!==par&&this!==par&&par.parents().indexOf(this)<0&&(_.parent&&_.parent.remove(this),_.parent=par,par&&_.parent.add(this)),_.parent},parents:function(){var par=this.parent(),ret;return par?(ret=par.parents(),ret.unshift(par),ret):[]},children:function(narrow,deep){var _=this._,ret=[],retVal,c;deep=narrow===!0||!!deep,narrow=typeof narrow=="boolean"?!1:narrow;if(!narrow){for(var id in _.children)ret.push(c=_.children[id]),deep&&ret.push.apply(ret,c.children(narrow,deep));return ret}if(Tools.isFunction(narrow)){for(var id in _.children)retVal=!!narrow(c=_.children[id],id,this),retVal&&ret.push(c),deep&&ret.push.apply(ret,c.children(narrow,deep));return ret}if(typeof narrow=="string"){retVal=/^(#|\.)?([\w]+)$/.exec(narrow);if(!retVal)return[];var _=this._,prop=retVal[1]?retVal[1]==="#"?"id":"hasClass":"type",val=retVal[2];if(prop==="id"){c=_.children[val];if(c)return[c];if(deep)for(var id in _.children)if(c=_.children[id])return[c];return ret}for(var id in _.children)c=_.children[id],retVal=c[prop]()===val,retVal&&ret.push(c),deep&&ret.push.apply(ret,c.children(narrow,deep))}return ret},contains:function(child){if(this===child)return!1;var _=this._;for(var i=0,l=_.children.length;i<l;++i)if(child===_.children[i]||_.children[i].contains(child))return!0;return!1},data:function(hash,val){return val?this._.data[hash]=val:this._.data[hash]}},"Body");return Body.isBody=function(b){return b instanceof Body},Body}),define("physics/world",["../util/tools","../util/class","./body","../math/vector"],function(Tools,Class,Body,Vector){var World=Class({_type:"world",_events:Body.prototype._events.concat(["step"]),World:function(){World.prototype.__extends__.call(this);var _=this._;_.interactions={beforeAccel:[],afterAccel:[],afterInertia:[]},_.childCache=null,_.refreshChildren=!0,this.subscribe("children.modified",function(){_.refreshChildren=!0}),_.dimensions=new Vector,_.dimensions.set(1/0,1/0,1/0),_.dt=8},__extends__:Body,parent:function(){return!1},dimensions:function(x,y,z){var d=this._.dimensions;return arguments.length>0&&d.set(x!==undefined?x:d.x,y!==undefined?y:d.y,z!==undefined?z:d.z),d.toNative()},registerInteraction:function(type,bodies,callback,par){var _=this._,intr={},p=par||this;return type in _.interactions&&(Tools.isFunction(bodies)?(p.subscribe("children.modified",function(modified){intr.bodies=bodies(par)}),intr.bodies=bodies(par)):intr.bodies=bodies,intr.parent=par,intr.callback=callback,_.interactions[type].push(intr)),this},doInteractions:function(type,dt){var list=this._.interactions[type],intr,bodies,par,ch,i,l,j,m;if(!list)return this;for(i=0,l=list.length;i<l;++i){intr=list[i],bodies=intr.bodies,par=intr.parent;for(j=0,m=bodies.length;j<m;++j)intr.callback.call(ch=bodies[j],dt,ch,j,bodies,par)}return this},resolveAcceleration:function(dt){var children=this._.childCache,i=children.length-1;for(;i>-1;i--)children[i].resolveAcceleration(dt)},resolveInertia:function(dt){var children=this._.childCache,i=children.length-1;for(;i>-1;i--)children[i].resolveInertia(dt)},onestep:function(){var _=this._,dt=_.dt;return _.refreshChildren&&(_.childCache=this.children(function(c){return c.timeStep(_.dt),!0},!0),_.refreshChildren=!1),_.time+=dt,this.doInteractions("beforeAccel",dt),this.resolveAcceleration(dt),this.doInteractions("afterAccel",dt),this.resolveInertia(dt),this.doInteractions("afterInertia",dt),_.time},timeStep:function(dt){if(dt){this._.dt=dt;if(!this._.childCache)return this;var children=this._.childCache,i=children.length-1;for(;i>-1;i--)children[i].timeStep(dt);return this}return this._.dt},step:function(now){if(this.paused)return this;var _=this._,time=_.time||(_.time=now),diff=now-time;if(!diff)return this;this.FPS=1e3/diff,this.nsteps=Math.ceil(diff/_.dt),now-time>250&&(_.time=now-250);while(this.onestep()<now);return this._fire("step",[_.dt,_.time]),this},pause:function(){return this.paused=!0,this._.time=!1,this},unpause:function(){return this.paused=!1,this},isPaused:function(){return!!this.paused}},"World");return World.isWorld=function(w){return w instanceof World},World}),define("physics/phygets/basic",["../../util/class","../../util/tools","../../math/vector","../body"],function(Class,Tools,Vector,Body){var Basic=Class({_type:"basic",_events:Body.prototype._events.concat(["physics.modified"]),Basic:function(){Basic.prototype.__extends__.call(this);var _=this._;_.pos=new Vector,_.mid=new Vector,_.prev=new Vector,_.v=new Vector,_.a=new Vector,_.dt=1,_.dimensions=new Vector,_.midInt=!1},__extends__:Body,resolveAcceleration:function(dt){var _=this._;if(_.attr.fixed)return;_.midInt=!0,_.mid.clone(_.pos),_.pos.vadd(_.a.mult(dt*dt)),_.a.zero()},resolveInertia:function(dt){var _=this._;if(_.attr.fixed)return;_.midInt=!1,_.pos.vadd(_.mid).vsub(_.prev),_.prev.clone(_.mid)},dimensions:function(x,y,z){var d=this._.dimensions;return arguments.length>0&&d.set(x!==undefined?x:d.x,y!==undefined?y:d.y,z!==undefined?z:d.z),d.toNative()},AABB:function(){return{x:0,y:0,z:0}},position:function(pos,y,z){var _=this._,type,prev=!1;if(pos!==undefined||y!==undefined||z!==undefined)type=typeof pos,type==="object"?_.pos.set(pos.x!==undefined?pos.x:_.pos.x,pos.y!==undefined?pos.y:_.pos.y,pos.z!==undefined?pos.z:_.pos.z):_.pos.set(pos!==undefined?pos:_.pos.x,y!==undefined?y:_.pos.y,z!==undefined?z:_.pos.z);return _.pos.toNative()},velocity:function(vel,y,z){var _=this._,pos=_.pos,type,isfixed=_.attr.fixed;return isfixed?_.v.zero().toNative():vel!==undefined||y!==undefined||z!==undefined?(type=typeof vel,_.mid.clone(_.pos),type==="object"?_.prev.clone(_.mid).vsub(_.v.set(vel.x!==undefined?vel.x:0,vel.y!==undefined?vel.y:0,vel.z!==undefined?vel.z:0).mult(_.dt)):_.prev.clone(_.mid).vsub(_.v.set(vel!==undefined?vel:0,y!==undefined?y:0,z!==undefined?z:0).mult(_.dt)),_.v.mult(1/_.dt).toNative()):_.v.clone(pos).vsub(_.prev).mult(1/_.dt).toNative()},accelerate:function(accel,y,z){var _=this._,type,isfixed=_.attr.fixed;if(isfixed)return _.a.zero().toNative();if(accel!==undefined||y!==undefined||z!==undefined)type=typeof accel,type==="object"?_.a.add(accel.x!==undefined?accel.x:0,accel.y!==undefined?accel.y:0,accel.z!==undefined?accel.z:0):_.a.add(accel!==undefined?accel:0,y!==undefined?y:0,z!==undefined?z:0);return this},timeStep:function(dt){if(dt){var v=this.velocity();return this._.dt=dt,this.velocity(v),this}return this._.dt}},"Basic");return Basic}),define("physics/phygets/sphere",["../../util/class","./basic"],function(Class,Basic){var Sphere=Class({_type:"sphere",Sphere:function(){Sphere.prototype.__extends__.call(this),this._.radius=0},__extends__:Basic,dimensions:function(r){return r!==undefined&&(this._.radius=r||r.radius||0),{radius:this._.radius}},AABB:function(){var _=this._;return{x:_.radius,y:_.radius,z:_.radius}}},"Sphere");return Sphere}),define("physics/phygets/point",["../../util/class","./basic"],function(Class,Basic){var Point=Class({_type:"point",Point:function(){Point.prototype.__extends__.call(this)},__extends__:Basic,dimensions:function(){return{x:0,y:0,z:0}}},"Point");return Point}),define("physics/phyget",["./body","./phygets/sphere","./phygets/point"],function(Body,Sphere,Point){function create(type){return new PhygetRegistry[type]}function isBody(b){var bdy=b,ret=!1;while(bdy&&!(ret=bdy instanceof Body))bdy=bdy.__extends__;return ret}var PhygetRegistry={sphere:Sphere,point:Point};return{create:create,isBody:isBody}}),define("pquery",["./util/slick.parser","./util/tools","./util/callbacks","./util/ticker","./math/vector","./physics/algorithms","./physics/world","./physics/phyget"],function(Slick,Tools,Callbacks,Ticker,Vector,Algorithms,World,Phyget){function inWorld(body,world){var p=body.parents();return p[p.length-1]===world}var pQuery=function(selector,context){return new pQuery.fn.init(selector,context,rootpQuery)},noContext=!1,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rootpQuery,worldMethods;return pQuery.fn=pQuery.prototype={constructor:pQuery,init:function(selector,context,rootpQuery){var match,elem,ret,doc;if(!selector)return this;if(Phyget.isBody(selector))return this.context=this[0]=selector,this.length=1,this;if(selector==="world"&&!context)return this.context=this.world,this[0]=this.world,this.selector=selector,this.length=1,this;if(typeof selector=="string"){selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3?match=[null,selector,null]:match=quickExpr.exec(selector);if(!match||!match[1])return!context||context.pquery?(context||rootpQuery).find(selector):this.constructor(context).find(selector);if(match[1])return context=context instanceof pQuery?context[0]:context,doc=context||this.world,ret=rsingleTag.exec(selector),ret?selector=[pQuery.createPhyget(ret[1])]:pQuery.error("Only simple <tag> creation is supported"),pQuery.merge(this,selector)}return selector.selector!==undefined&&(this.selector=selector.selector,this.context=selector.context),pQuery.makeArray(selector,this)},selector:"",pquery:"0.1a",length:0,each:function(callback,args){return pQuery.each(this,callback,args)},pushStack:function(elems,name,selector){var ret=this.constructor();return pQuery.isArray(elems)?this.push.apply(ret,elems):pQuery.merge(ret,elems),ret.prevObject=this,ret.context=this.context,name==="find"?ret.selector=this.selector+(this.selector?" ":"")+selector:name&&(ret.selector=this.selector+"."+name+"("+selector+")"),ret},push:Array.prototype.push},pQuery.fn.init.prototype=pQuery.fn,pQuery.fn.extend=pQuery.extend=Tools.extend,pQuery.extend(Tools),pQuery.extend(Algorithms),pQuery.Callbacks=Callbacks,pQuery.Vector=Vector,pQuery.extend({ticker:Ticker,sub:function(){function pQuerySub(selector,context){return new pQuerySub.fn.init(selector,context)}pQuery.extend(!0,pQuerySub,this),pQuerySub.superclass=this,pQuerySub.fn=pQuerySub.prototype=this(),pQuerySub.fn.constructor=pQuerySub,pQuerySub.fn.world=new World,pQuerySub.sub=this.sub,pQuerySub.fn.init=function(selector,context){return context&&context instanceof pQuery&&!(context instanceof pQuerySub)&&(context=pQuerySub(context)),pQuery.fn.init.call(this,selector,context,rootpQuerySub)},pQuerySub.fn.init.prototype=pQuerySub.fn;var rootpQuerySub=pQuerySub("world");return pQuerySub},createPhyget:function(type){var ret=Phyget.create(type);return ret||pQuery.error("Invalid phyget type: "+type),ret}}),!function(){function makeArray(array,results){return array=Array.prototype.slice.call(array,0),results?(results.push.apply(results,array),results):array}pQuery.find=function(selector,context,results){function filter(child,id,parent){var acceptParents,body,testid,check,comb,last,j,currentBit,i,currentExpression;e:for(i=0;currentExpression=expressions[i];i++){acceptParents={},body=child,testid=id,last=currentExpression.length-1,j=last,currentBit=currentExpression[j];do{testid=body.id();if(j===currentExpression.length-2&&acceptParents[testid])return!0;check=!currentBit.id||currentBit.id===testid,check=check&&(!currentBit.classList||body.hasClass.apply(body,currentBit.classList)),check=check&&(!currentBit.tag||currentBit.tag==="*"||body.type()===currentBit.tag);if(j===last){if(!check)continue e}else{if(comb===">"&&!check)continue e;if(!check)continue}comb=currentBit.combinator,j--,currentBit=currentExpression[j];if(!currentBit){if(comb===">"&&body.parent()!==context)continue e;return acceptParents[child.parent().id()]=!0,!0}}while((body=body.parent())&&body!==context)}return!1}results=results||[];if(!selector||typeof selector!="string")return results;context||(context=rootpQuery.world),context.type()==="world"&&(selector=selector.replace(/^world ?/,""));var selectorObj=Slick.parse(selector),expressions=selectorObj.expressions;return makeArray(context.children(filter,!0),results),results}}(),pQuery.contains=function(haystack,needle){return haystack.contains(needle)},pQuery.fn.extend({toArray:function(){return Array.prototype.slice.call(this,0)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]}}),pQuery.fn.extend({world:new World,find:function(selector){var self=this,i,l;if(typeof selector!="string")return pQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++)if(pQuery.contains(self[i],this))return!0});var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length,pQuery.find(selector,this[i],ret);if(i>0)for(n=length;n<ret.length;n++)for(r=0;r<length;r++)if(ret[r]===ret[n]){ret.splice(n--,1);break}}return ret},contains:function(){},add:function(selector,context){var set=typeof selector=="string"?pQuery(selector,context):pQuery.makeArray(selector&&Phyget.isBody(selector)?[selector]:selector),all=pQuery.merge(this.get(),set);return this.pushStack(!inWorld(set[0],this.world)||!inWorld(all[0],this.world)?all:pQuery.unique(all))},append:function(){return this.manip(arguments,function(body){this.add(body)})},appendTo:function(){return this.manip(arguments,function(body){this.addTo(body)})},manip:function(args,callback){var value=args[0],fragment=value.pquery?value[0]:value;if(this[0])for(var i=0,l=this.length;i<l;i++)callback.call(this[i],fragment);return this}}),pQuery.fn.extend({interact:function(types,sel,callback){var bodies,type=types;if(typeof types=="object"){for(type in types)this.interact(type,sel,types[type]);return this}sel==null&&callback==null?(callback=types,type="beforeAccel"):callback==null&&(callback=sel,sel=undefined,type=types);if(!callback)return this;if(!sel)bodies=pQuery.makeArray(this),this.world.registerInteraction(type,bodies,callback);else for(var i=0,l=this.length;i<l;++i)bodies=function(par){var p=pQuery(par);return function(){return pQuery.makeArray(p.find(sel))}}(this[i]),this.world.registerInteraction(type,bodies,callback,this[i]);return this},uninteract:function(){},accelerate:function(accel){var ch=this[0],x,y,z;if(typeof accel=="object"&&(x=accel.x)!==0||(y=accel.y)!==0||(z=accel.z)!==0||(x=accel)!==0||(y=arguments[1])!==0||(z=arguments[2])!==0)for(var i=this.length-1;i>-1;i--)ch=this[i],ch.accelerate(x,y,z);return this}}),pQuery.fn.extend({step:function(now){return this.world.step(now),this},timeStep:function(dt){return dt?(this.world.timeStep(dt),this):this.world.timeStep()},pause:function(){return this.world.pause(),this},unpause:function(){return this.world.unpause(),this},isPaused:function(){return this.world.isPaused()}}),rootpQuery=pQuery("world"),pQuery.fn.extend({id:function(value){return pQuery.isFunction(value)?pQuery.fn.id.call(this,value.call(this,0,this[0])):this[0]?this[0].id(value):null},addClass:function(value){if(pQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.classes()))});if(value&&typeof value=="string")for(var i=0,l=this.length;i<l;++i)this[i].addClass(value);return this},removeClass:function(value){if(pQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.classes()))});if(value&&typeof value=="string")for(var i=0,l=this.length;i<l;++i)this[i].removeClass(value);return this},toggleClass:function(value,stateVal){if(pQuery.isFunction(value))return this.each(function(i){pQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)});for(var i=0,l=this.length;i<l;++i)this[i].toggleClass(value,stateVal);return this},data:function(hash,val){if(!val)return this[0]?this[0].data(hash):null;for(var i=0,l=this.length;i<l;++i)this[i].data(hash,val);return this}}),pQuery.fn.extend({type:function(){var first=this[0];return first&&first.type()},classes:function(){var first=this[0];return first&&first.classes()},parents:function(){var ret,i,l,n;for(i=0,l=this.length;i<l;i++)if(i==0)ret=this[i].parents();else{ret.push.apply(ret,this[i].parents());for(n=length;n<ret.length;n++)for(r=0;r<length;r++)if(ret[r]===ret[n]){ret.splice(n--,1);break}}return ret},position:function(pos){var first=this[0];if(typeof pos!="string"&&arguments.length>0){for(var i=this.length-1;i>-1;i--)first=this[i],first.position.apply(first,arguments);return this}return first&&first.position&&first.position()},velocity:function(vel){var first=this[0];if(typeof pos!="string"&&arguments.length>0){for(var i=this.length-1;i>-1;i--)first=this[i],first.velocity.apply(first,arguments);return this}return first&&first.velocity&&first.velocity()},dimensions:function(dims){var type=typeof dims,first=this[0];if(type==="object"){for(var i=0,l=this.length;i<l;++i)this[i].dimensions(dims.width,dims.height,dims.depth);return this}if(pQuery.isNumeric(dims)){dims={width:dims,height:arguments[1],depth:arguments[2]};for(var i=0,l=this.length;i<l;++i)this[i].dimensions(dims.width,dims.height,dims.depth);return this}return first.dimensions()}}),pQuery.fn.extend({hasClass:function(value){var first=this[0];return first&&first.hasClass.apply(first,arguments)}}),pQuery.fn.extend({on:function(evt,callback){var i,el;for(var i=this.length-1;i>-1;i--)el=this[i],el.subscribe(evt,pQuery.proxy(callback,el));return this}}),pQuery}),require(["pquery"],function(p){window.pQuery=p})})(this,this.document)